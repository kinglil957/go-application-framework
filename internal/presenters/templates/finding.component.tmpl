{{define "finding"}}
{{- (renderToString "severity" . | toUpperCase | renderInSeverityColor )}} {{print .Attributes.Message.Header | bold}}
{{- if .Attributes.HighestSuppression }}{{if eq .Attributes.HighestSuppression.Status "accepted" }} [ IGNORED ]
{{- else if eq .Attributes.HighestSuppression.Status "underReview" }} [ PENDING IGNORE... ] {{- else}}{{end -}}
{{- else}}{{end -}}

{{- range $location := $.Attributes.Locations}}
   {{- if $location.SourceLocations}}
   Path: {{$location.SourceLocations.Filepath}}, line {{$location.SourceLocations.OriginalStartLine}}
   {{- end }}
{{- end }}
   Info: {{.Attributes.Message.Text}}

   {{- if .Attributes.HighestSuppression}}
   {{- if or (eq .Attributes.HighestSuppression.Status "accepted") (eq .Attributes.HighestSuppression.Status "underReview")}}

   Expiration: {{ formatDatetime .Attributes.HighestSuppression.Details.Expiration "2006-01-02T15:04:05.999999999Z07:00" "January 02, 2006" }}
   Category:   {{ .Attributes.HighestSuppression.Details.Category }}
   Ignored on: {{ formatDatetime .Attributes.HighestSuppression.Details.IgnoredOn "2006-01-02T15:04:05.999999999Z07:00" "January 02, 2006" }}
   Ignored by: {{ .Attributes.HighestSuppression.Details.IgnoredBy.Name }}
   Reason:     {{ .Attributes.HighestSuppression.Justification }}
   {{- end}}
   {{- end}}
{{end}}

{{- define "severity"}}
  {{- if or (not .Attributes.HighestSuppression) (and (.Attributes.HighestSuppression) (eq .Attributes.HighestSuppression.Status "rejected"))}} âœ— {{else}} ! {{end -}}
  [{{.Attributes.Rating.Severity.Value}}]
{{- end}}